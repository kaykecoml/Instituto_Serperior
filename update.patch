diff --git a/creation.html b/creation.html
index 21b09cc79a4ad64d3e1aae2fde69603145880687..8ac00c732579ad630529c7edef1bc4359373c3ea 100644
--- a/creation.html
+++ b/creation.html
@@ -1,162 +1,108 @@
 <!DOCTYPE html>
 <html lang="pt-br">
 <head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Criação Pokémon</title>
   <link rel="stylesheet" href="css/pokemon.css">
   <link rel="stylesheet" href="css/creation.css">
   <link rel="icon" href="assets/logo.png">
-  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <script type="module" src="js/creation.js"></script>
 </head>
 <body>
-  <aside id="sideMenu" class="side-menu" aria-hidden="true">
-    <div class="side-menu-header">Menu</div>
-    <div class="side-menu-divider"></div>
-    <div class="side-menu-actions top">
-      <a class="side-menu-btn" href="pokemon.html">Pokedex</a>
-      <a class="side-menu-btn" href="moves.html">Lista de golpes</a>
-      <a class="side-menu-btn" href="creation.html">Criação</a>
-      <a class="side-menu-btn" href="created-pokemons.html">Pokémons Criados</a>
-      <a class="side-menu-btn" href="favoritos.html">Favorito</a>
-    </div>
-    <button class="side-menu-btn side-menu-login" type="button">Logar</button>
-  </aside>
-  <div id="sideMenuBackdrop" class="side-menu-backdrop hidden"></div>
-
   <header>
-    <button id="logoMenuBtn" class="logo-button" type="button" aria-label="Abrir menu lateral">
-      <img src="assets/logo.png" class="logo" alt="Instituo Serperior">
-    </button>
-    <div class="title-container">
-      <h1><a href="index.html" class="site-home-link">Instituo Serperior</a></h1>
-      <h2>Criação</h2>
-    </div>
+    <button id="logoMenuBtn" class="logo-button" type="button" aria-label="Abrir menu lateral"><img src="assets/logo.png" class="logo" alt="Instituo Serperior"></button>
+    <div class="title-container"><h1><a href="index.html" class="site-home-link">Instituo Serperior</a></h1><h2>Criação</h2></div>
   </header>
 
   <main class="creation-layout">
     <section class="builder-panel">
       <div class="mode-switch" role="tablist" aria-label="Modo de criação">
         <button class="mode-btn active" data-mode="wild" type="button">Pokémon Selvagem</button>
         <button class="mode-btn" data-mode="trained" type="button">Pokémon Adestrado</button>
-        <button class="mode-btn" data-mode="generation" type="button">Geração</button>
       </div>
 
-      <div class="builder-block search-block">
+      <div class="builder-block">
         <h3>Espécie</h3>
         <div class="search-controls">
           <input id="speciesSearch" type="text" placeholder="Nome ou ID do Pokémon" autocomplete="off">
           <button id="speciesSearchBtn" type="button">Buscar</button>
         </div>
         <div id="speciesPreview" class="search-preview"></div>
       </div>
 
       <div class="builder-block" id="basicControls" hidden>
-        <h3>DETALHES</h3>
+        <h3>Detalhes</h3>
         <div class="details-grid">
-          <label id="nicknameWrap">Apelido (Opcional)<input id="nicknameInput" type="text" maxlength="30"></label>
-          <label>Nv.<input id="levelInput" type="number" min="1" max="100" value="5"></label>
-          <div id="loyaltyWrap">
-            <span>Lealdade</span>
-            <div id="loyaltyBlocks" class="loyalty-blocks" aria-label="Lealdade"></div>
-          </div>
-          <div>
-            <span>Habilidades</span>
-            <button id="openAbilitiesModalBtn" type="button">Habilidades</button>
-          </div>
-          <div>
+          <label class="field">Nível <input id="levelInput" type="number" min="1" max="100" value="5"></label>
+          <label class="field" id="nicknameWrap">Apelido <input id="nicknameInput" type="text" maxlength="30"></label>
+          <div class="field">
             <span>Gênero</span>
-            <button id="genderDropdownBtn" type="button">Gênero: —</button>
-            <div id="genderMenu" class="inline-pop hidden"></div>
-          </div>
-          <div class="toggle-group">
-            <button id="shinyToggle" class="icon-toggle" type="button"><img src="assets/forms/shiny.png" alt="Shiny">Shiny</button>
-            <button id="alphaToggle" class="icon-toggle" type="button"><img src="assets/icons/alpha.png" alt="Alpha">Alpha</button>
-          </div>
-          <div id="ballWrap" class="ball-wrap" hidden>
-            <span>Pokebola capturada</span>
-            <div id="pokeballGrid" class="pokeball-grid"></div>
-          </div>
-          <div id="xpControls" hidden>
-            <span>XP (Adestrado)</span>
-            <div class="xp-inline"><input id="xpInput" type="number" min="0" value="0"><button id="addXpBtn" type="button">Adicionar XP</button></div>
+            <button id="genderDropdownBtn" type="button" aria-expanded="false" aria-controls="genderMenu">Gênero: —</button>
+            <div id="genderMenu" class="inline-pop hidden" role="menu"></div>
           </div>
+          <div class="field"><span>Habilidades</span><button id="openAbilitiesModalBtn" type="button">Selecionar habilidades</button></div>
+          <div class="field toggle-group"><button id="shinyToggle" class="icon-toggle" type="button"><img src="assets/forms/shiny.png" alt="Shiny">Shiny</button><button id="alphaToggle" class="icon-toggle" type="button"><img src="assets/icons/alpha.png" alt="Alpha">Alpha</button></div>
+          <div class="field" id="xpControls" hidden><span>XP (Adestrado)</span><div class="xp-inline"><input id="xpInput" type="number" min="0" value="0"><button id="addXpBtn" type="button">add xp</button></div></div>
+          <div class="field" id="ballWrap" hidden><span>Pokébola capturada</span><button id="openPokeballModalBtn" type="button">Escolher pokébola</button><small id="selectedBallText"></small></div>
+          <div class="field" id="loyaltyWrap" hidden><span>Lealdade</span><div id="loyaltyBlocks" class="loyalty-blocks"></div></div>
         </div>
       </div>
 
-      <div class="builder-block" id="natureBlock" hidden>
-        <h3>NATUREZA</h3>
-        <select id="natureSelect"></select>
-      </div>
-
-      <div id="generationControls" class="builder-block" hidden>
-        <h3>Geração</h3>
-        <button id="quickGenerateBtn" type="button">Gerar configuração aleatória</button>
-      </div>
+      <div class="builder-block" id="natureBlock" hidden><h3>Natureza</h3><select id="natureSelect"></select></div>
 
-      <div class="builder-block moves-selectors" id="movesSection" hidden>
-        <h3>Selecionar golpes</h3>
+      <div class="builder-block" id="movesSection" hidden>
+        <h3>Golpes</h3>
         <div class="move-builder-grid">
           <div>
             <h4>Level Moves</h4>
             <div class="inline-row"><select id="levelMoveSelect"></select><button id="addLevelMoveBtn" type="button">Adicionar</button></div>
             <ul id="levelMoveSlots" class="move-slots"></ul>
           </div>
           <div>
             <h4>TM / Tutor / Egg</h4>
             <div class="inline-row"><select id="tmMoveSelect"></select><button id="addTmMoveBtn" type="button">Adicionar</button></div>
             <ul id="tmMoveSlots" class="move-slots"></ul>
           </div>
         </div>
       </div>
     </section>
 
     <section class="sheet-panel">
-      <h3>FICHA</h3>
+      <h3>Ficha</h3>
       <div id="sheetEmpty">Selecione um Pokémon para começar.</div>
       <div id="sheetContent" hidden>
         <div class="sheet-main">
           <div class="sheet-image-card">
             <button id="sheetImageButton" type="button" class="sheet-image-frame"><img id="sheetSprite" alt="Pokémon selecionado"><span id="sheetBallIcon"></span><span id="sheetBadges"></span></button>
             <div class="xp-bar"><span id="xpBarFill"></span></div><small id="xpBarText"></small>
-          </div>
-          <div class="sheet-head-content">
-            <p id="sheetModeLabel"></p>
             <div class="dex-line"><span id="sheetDex"></span><strong id="sheetName"></strong><span id="sheetLevel"></span></div>
-            <p id="sheetSpeciesSub"></p>
-            <div id="sheetTypes"></div>
           </div>
+          <div><p id="sheetSpeciesSub"></p><div id="sheetTypes"></div><div id="selectedAbilitiesView"></div></div>
         </div>
-        <hr>
-        <div class="type-relations">
-          <div><h4>Fraquezas</h4><div id="weaknesses" class="icon-list"></div></div>
-          <div><h4>Resistências</h4><div id="resistances" class="icon-list"></div></div>
-          <div><h4>Imunidades</h4><div id="immunities" class="icon-list"></div></div>
-        </div>
+
+        <div class="health-bars"><div><span>HP Total</span><div class="hp-bar hp1"><span id="hp1Fill"></span></div><small id="hp1Text"></small></div><div><span>HP Rápido</span><div class="hp-bar hp2"><span id="hp2Fill"></span></div><small id="hp2Text"></small></div></div>
+
+        <div class="stats-board" id="statsBoard"></div>
+
+        <div class="type-relations"><div><h4>Fraquezas</h4><div id="weaknesses" class="icon-list"></div></div><div><h4>Resistências</h4><div id="resistances" class="icon-list"></div></div><div><h4>Imunidades</h4><div id="immunities" class="icon-list"></div></div></div>
+
         <div class="capacities-wrapper">
           <div class="capacity"><span class="capacity-title">INTELIGÊNCIA</span><span class="capacity-value" id="cap-int">0</span><span class="capacity-label" id="cap-int-label"></span></div>
           <div class="capacity"><span class="capacity-title">FORÇA</span><span class="capacity-value" id="cap-str">0</span><span class="capacity-label" id="cap-str-label"></span></div>
           <div class="capacity"><span class="capacity-title">DESLOCAMENTO</span><span class="capacity-value" id="cap-mov">0</span><span class="capacity-label" id="cap-mov-label"></span></div>
         </div>
-        <div class="stats-compact" id="statsCompact"></div>
-        <div class="radar-buttons"><button id="openStatsRadar" type="button">Radar de atributos basais</button><button id="openContestRadar" type="button">Radar de concurso</button></div>
-        <div class="health-bars"><div><span>HP Total</span><div class="hp-bar hp1"><span id="hp1Fill"></span></div><small id="hp1Text"></small></div><div><span>HP Rápido</span><div class="hp-bar hp2"><span id="hp2Fill"></span></div><small id="hp2Text"></small></div></div>
-        <h4>Golpes selecionados</h4>
-        <ul id="selectedMovesOutput" class="move-output"></ul>
-        <div class="actions-row"><button id="copySheetBtn" type="button">Copiar ficha</button><button id="copyMovesBtn" type="button">Copiar golpes</button><button id="savePokemonBtn" type="button">Salvar</button></div>
+
+        <h4>Golpes selecionados</h4><ul id="selectedMovesOutput" class="move-output"></ul>
+        <div class="actions-row"><button id="savePokemonBtn" type="button">Salvar</button></div>
       </div>
     </section>
 
-    <aside class="info-tab" id="infoTab">
-      <h3>Aba de informações</h3>
-      <div id="infoContent"></div>
-    </aside>
+    <aside class="info-tab"><h3>Informações</h3><div id="infoContent"></div></aside>
   </main>
 
   <dialog id="abilitiesModal" class="sheet-modal"><div class="modal-head"><h3>Habilidades</h3><button data-close-modal="abilitiesModal" type="button">✕</button></div><div id="abilitiesModalBody"></div></dialog>
-  <dialog id="moveDetailsModal" class="sheet-modal"><div class="modal-head"><h3 id="moveModalTitle">Golpe</h3><button data-close-modal="moveDetailsModal" type="button">✕</button></div><div id="moveDetailsBody"></div></dialog>
-  <dialog id="radarModal" class="sheet-modal"><div class="modal-head"><h3 id="radarTitle">Radar</h3><button data-close-modal="radarModal" type="button">✕</button></div><div id="radarBody"></div></dialog>
+  <dialog id="pokeballModal" class="sheet-modal"><div class="modal-head"><h3>Pokébola capturada</h3><button data-close-modal="pokeballModal" type="button">✕</button></div><div id="pokeballModalBody"></div></dialog>
   <dialog id="imageCropModal" class="sheet-modal"><div class="modal-head"><h3>Imagem customizada</h3><button data-close-modal="imageCropModal" type="button">✕</button></div><div id="cropBody"></div></dialog>
 </body>
 </html>
diff --git a/css/creation.css b/css/creation.css
index 85f879946f9a44e60dd7e8b298a79773e5d8682d..6c76d68cb05ab355dc659d3a5deb68d806db724e 100644
--- a/css/creation.css
+++ b/css/creation.css
@@ -1,65 +1,47 @@
-* { box-sizing: border-box; }
-body { overflow-x: hidden; }
-.creation-layout { display:grid; grid-template-columns:minmax(0,1.1fr) minmax(0,1fr) 320px; gap:12px; padding:12px; max-width:1400px; margin:0 auto; }
+*{box-sizing:border-box} body{overflow-x:hidden}
+.creation-layout{display:grid;grid-template-columns:minmax(0,1fr) minmax(0,1fr) 300px;gap:12px;padding:12px;max-width:1400px;margin:0 auto}
 .builder-panel,.sheet-panel,.info-tab{background:linear-gradient(180deg,#16291f,#0d1712);border:2px solid #2f6b44;border-radius:14px;padding:12px;min-width:0}
-.mode-switch{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;margin-bottom:10px}
-.mode-btn{font-size:11px;padding:8px 6px}
-.builder-block{border:1px solid rgba(123,220,101,.5);border-radius:10px;padding:10px;margin-bottom:10px}
-.builder-block h3,.sheet-panel h3,.sheet-panel h4,.info-tab h3{margin:0 0 8px;color:#7bdc65;font-family:Pixel}
-label,input,select,button,span,p,small,strong,li,h4,div{font-family:Pixel}
+.builder-block{border:1px solid rgba(123,220,101,.5);border-radius:10px;padding:10px;margin-bottom:10px;min-width:0}
+.builder-block h3,.sheet-panel h3,.sheet-panel h4,.info-tab h3,label,input,select,button,span,p,small,strong,li,div{font-family:Pixel}
+.mode-switch{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-bottom:10px}
 input,select,button{border:1px solid #7bdc65;background:#163321;color:#fff;border-radius:8px;padding:8px;min-width:0}
 .search-controls{display:grid;grid-template-columns:minmax(0,1fr) auto;gap:8px}
-.search-preview{margin-top:8px;max-height:220px;overflow:auto;border:1px solid rgba(123,220,101,.3);border-radius:8px;display:flex;flex-direction:column}
-.preview-item{width:100%;display:flex;align-items:center;gap:8px;background:transparent;border:none;border-bottom:1px solid rgba(123,220,101,.3);text-align:left;padding:8px}
-.preview-item img{width:36px;height:36px}
+.search-preview{margin-top:8px;max-height:220px;overflow:auto;border:1px solid rgba(123,220,101,.3);border-radius:8px}
+.preview-item{display:flex;gap:8px;width:100%;border:none;border-bottom:1px solid rgba(123,220,101,.3);background:none;padding:8px;align-items:center;text-align:left}
 .details-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;align-items:end}
-#levelInput{max-width:96px}
-.loyalty-blocks{display:flex;gap:4px}
-.loyalty-block{background:#08110d;border:1px solid #7bdc65;border-radius:6px;padding:4px 6px;cursor:pointer}
-.inline-pop{display:flex;gap:6px;margin-top:6px}
-.icon-toggle{display:inline-flex;align-items:center;gap:6px}
-.icon-toggle img{width:16px;height:16px}
-.icon-toggle.active{box-shadow:0 0 10px rgba(255,236,130,.85)}
+.field{display:flex;flex-direction:column;gap:6px;min-width:0}
+#levelInput{max-width:90px}
+.inline-pop{display:flex;gap:6px;flex-wrap:wrap}.inline-pop button{display:flex;gap:6px;align-items:center}
+#genderDropdownBtn.gender-male{border-color:#5fa4ff}#genderDropdownBtn.gender-female{border-color:#ff6eb5}#genderDropdownBtn.gender-asexual{border-color:#5e7a68}
+.icon-toggle{display:inline-flex;align-items:center;gap:6px}.icon-toggle img{width:16px;height:16px}.icon-toggle.active{box-shadow:0 0 10px rgba(255,236,130,.85);outline:1px solid #ffe774}
 .toggle-group{display:flex;gap:8px;flex-wrap:wrap}
-.pokeball-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:6px}
-.pokeball-item{display:flex;gap:6px;align-items:center;justify-content:center;padding:6px}
-.pokeball-item.active{border-color:#ffe774}
-.pokeball-item img{width:24px;height:24px}
 .xp-inline{display:flex;gap:6px}
+.loyalty-blocks{display:flex;gap:8px;font-size:24px}.loyalty-block{border:none;background:none;color:#7bdc65;padding:0}.loyalty-block.active{color:#eaffea}
 .move-builder-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
 .inline-row{display:grid;grid-template-columns:minmax(0,1fr) auto;gap:8px}
-.move-slots,.move-output,.icon-list{list-style:none;padding:0;margin:0}
-.move-slots li,.move-output li{padding:6px;border-radius:8px;border:1px solid rgba(123,220,101,.4);margin-bottom:6px;cursor:pointer}
+.move-slots,.move-output,.icon-list{list-style:none;margin:0;padding:0}
+.move-slots li,.move-output li{padding:6px;border-radius:8px;border:1px solid rgba(123,220,101,.4);margin-bottom:6px;display:flex;justify-content:space-between;gap:8px}
 .sheet-main{display:grid;grid-template-columns:170px minmax(0,1fr);gap:10px}
-.sheet-image-frame{position:relative;border:3px solid #7bdc65;border-radius:12px;background:#08110d;padding:6px;width:100%;min-height:140px;display:flex;align-items:center;justify-content:center}
+.sheet-image-frame{position:relative;border:3px solid #7bdc65;border-radius:12px;background:#08110d;padding:6px;width:100%;min-height:140px;display:flex;align-items:center;justify-content:center;overflow:hidden}
 .sheet-image-frame img{max-width:100%;max-height:130px;object-fit:contain}
-#sheetBallIcon,#sheetBadges{position:absolute;top:6px}
-#sheetBallIcon{left:6px}
-#sheetBadges{right:6px;display:flex;flex-direction:column;gap:4px}
-.badge-icon{width:18px;height:18px}
-.xp-bar{height:12px;border:1px solid #2f6b44;border-radius:999px;overflow:hidden;margin-top:6px}
-.xp-bar span{display:block;height:100%;background:linear-gradient(90deg,#43e97b,#38f9d7);width:0}
-.dex-line{display:grid;grid-template-columns:80px 1fr 80px;gap:6px;align-items:center;text-align:center}
-#sheetTypes,.icon-list{display:flex;gap:6px;flex-wrap:wrap}
-#sheetTypes img,.icon-list img{width:68px;height:20px;object-fit:contain}
-.type-relations{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
-.capacities-wrapper{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;margin:10px 0}
-.capacity{border:1px solid rgba(123,220,101,.3);border-radius:8px;padding:6px;text-align:center}
-.capacity-value{font-size:20px;color:#7bdc65;display:block}
-.stats-compact{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;margin-bottom:8px}
-.stats-col{border:1px solid rgba(123,220,101,.3);padding:6px;border-radius:8px}
-.stats-col li{display:flex;justify-content:space-between;font-size:11px}
-.radar-buttons,.actions-row{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0}
-.health-bars{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
+#sheetBallIcon,#sheetBadges{position:absolute;top:6px;display:flex;gap:4px}#sheetBallIcon{left:6px;flex-wrap:wrap;max-width:55px}#sheetBadges{right:6px;flex-direction:column}
+.corner-icon,.badge-icon{width:18px;height:18px}
+.dex-line{display:grid;grid-template-columns:70px minmax(0,1fr) 64px;gap:6px;text-align:center;margin-top:8px}
+.dex-line strong,#sheetSpeciesSub,#xpBarText{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
+#sheetTypes,.icon-list{display:flex;gap:6px;flex-wrap:wrap}#sheetTypes img,.icon-list img{width:68px;height:20px;object-fit:contain}
+.xp-bar{height:12px;border:1px solid #2f6b44;border-radius:999px;overflow:hidden;margin-top:6px}.xp-bar span{display:block;height:100%;background:linear-gradient(90deg,#43e97b,#38f9d7);width:0}
+.stats-board{margin:10px 0;border:1px solid rgba(123,220,101,.35);border-radius:8px;padding:8px}
+.stats-row{display:grid;grid-template-columns:92px 1fr 1fr 1fr;gap:8px;font-size:11px;align-items:center}.stats-row.header{font-size:10px;opacity:.9}.nature-plus{color:#78b8ff}.nature-minus{color:#ff8080}
+.alloc-control{display:flex;gap:4px;align-items:center;justify-content:flex-end}.alloc-control button{padding:2px 6px}
+.type-relations,.capacities-wrapper,.health-bars{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
+.health-bars{grid-template-columns:repeat(2,minmax(0,1fr))}
 .hp-bar{background:#1d2520;border:1px solid #324c3a;border-radius:999px;height:16px;overflow:hidden}.hp-bar span{display:block;height:100%;width:100%}.hp1 span{background:linear-gradient(90deg,#23ab3a,#89db76)}.hp2 span{background:linear-gradient(90deg,#bf2a3a,#f56e6e)}
-.info-tab{position:sticky;top:10px;height:fit-content}
-.info-row{padding:6px 0;border-bottom:1px solid rgba(123,220,101,.25)}
-.move-chip{border:1px solid transparent}
+.capacity{border:1px solid rgba(123,220,101,.3);border-radius:8px;padding:6px;text-align:center}.capacity-value{font-size:20px;color:#7bdc65;display:block}
+.info-row{padding:6px 0;border-bottom:1px solid rgba(123,220,101,.25);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
 .sheet-modal{width:min(780px,96vw);border:1px solid #7bdc65;border-radius:12px;background:#102117;color:#fff;padding:0}.sheet-modal::backdrop{background:rgba(0,0,0,.65)}.modal-head{display:flex;justify-content:space-between;align-items:center;padding:10px;border-bottom:1px solid #2f6b44}
-#abilitiesModalBody,#moveDetailsBody,#radarBody,#cropBody{padding:10px;max-height:70vh;overflow:auto}
-.ability-option{border:1px solid rgba(123,220,101,.4);border-radius:8px;padding:8px;margin-bottom:8px;cursor:pointer}
-.ability-option.selected-1{border-color:#4cff5a}.ability-option.selected-2{border-color:#ffd14c}
-.move-details-title{text-align:center;font-family:Pixel;font-size:24px}
-.move-modal-shell{border:2px solid #7bdc65;border-radius:12px;padding:10px}
-.move-details-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px;text-align:center}
-@media (max-width: 1100px){.creation-layout{grid-template-columns:1fr}.info-tab{position:static}.mode-btn{font-size:10px}.details-grid,.move-builder-grid,.type-relations,.capacities-wrapper,.stats-compact,.health-bars{grid-template-columns:1fr}}
+#abilitiesModalBody,#cropBody,#pokeballModalBody{padding:10px;max-height:70vh;overflow:auto}
+.ability-option{width:100%;text-align:left;border:1px solid rgba(123,220,101,.4);border-radius:8px;padding:8px;margin-bottom:8px;color:#eaffea}.ability-option.hidden-ability{color:#999}.ability-option.selected-1{border-color:#4cff5a}.ability-option.selected-2{border-color:#ffd14c}
+.pokeball-item{width:100%;display:flex;gap:8px;align-items:center;margin-bottom:6px}.pokeball-item img{width:24px;height:24px}
+.crop-viewer{position:relative;height:260px;border:2px solid #2f6b44;border-radius:10px;overflow:hidden;touch-action:none;background:#08110d}.crop-viewer img{position:absolute;left:50%;top:50%;max-width:none;max-height:none;pointer-events:none}
+@media (max-width:1100px){.creation-layout{grid-template-columns:1fr}.info-tab{position:static}}
+@media (max-width:700px){.details-grid,.move-builder-grid,.type-relations,.capacities-wrapper,.health-bars{grid-template-columns:1fr}.sheet-main,.stats-row{grid-template-columns:1fr}}
diff --git a/index.html b/index.html
index 9965f06388f06fd2e415c7fdf3534fcf14329925..0cd4a64de01a26635d1250a2b30886d4a37f3464 100644
--- a/index.html
+++ b/index.html
@@ -63,41 +63,41 @@
     <a class="side-menu-btn" href="pokemon.html">Pokedex</a>
     <a class="side-menu-btn" href="moves.html">Lista de golpes</a>
     <button class="side-menu-btn" type="button">Lista de habilidades</button>
     <a class="side-menu-btn" href="favoritos.html">Favorito</a>
     <a class="side-menu-btn" href="creation.html">Criação</a>
     <a class="side-menu-btn" href="created-pokemons.html">Pokémons Criados</a>
   </div>
   <button class="side-menu-btn side-menu-login" type="button">Logar</button>
 </aside>
 <div id="sideMenuBackdrop" class="side-menu-backdrop hidden"></div>
 
   <header>
     <button id="logoMenuBtn" class="logo-button" type="button" aria-label="Abrir menu lateral">
       <img src="assets/logo.png" class="logo" alt="Instituo Serperior">
     </button>
     <div class="title-container">
       <h1><a href="index.html" class="site-home-link">Instituo Serperior</a></h1>
       <h2>Painel</h2>
     </div>
   </header>
 
   <main class="home-actions">
     <section class="home-actions-grid" aria-label="Menu principal">
       <a class="home-action-btn" href="pokemon.html">Registro Pokémon</a>
       <a class="home-action-btn" href="moves.html">Registro de Golpes</a>
-      <a class="home-action-btn" href="creation.html">Criação</a>
+      <a class="home-action-btn" href="creation.html">Criação (Builder)</a>
       <span class="home-action-btn is-disabled">Registro de Habilidade</span>
       <a class="home-action-btn" href="created-pokemons.html">Pokémons Criados</a>
     </section>
   </main>
   <script type="module">
   import { initAuthUI } from "./js/auth.js";
   const btn = document.getElementById("logoMenuBtn");
   const menu = document.getElementById("sideMenu");
   const backdrop = document.getElementById("sideMenuBackdrop");
   btn?.addEventListener("click", () => { menu?.classList.add("open"); backdrop?.classList.remove("hidden"); menu?.setAttribute("aria-hidden", "false"); });
   backdrop?.addEventListener("click", () => { menu?.classList.remove("open"); backdrop?.classList.add("hidden"); menu?.setAttribute("aria-hidden", "true"); });
   initAuthUI();
 </script>
 </body>
 </html>
diff --git a/js/creation.js b/js/creation.js
index b7ec241b126912d6c8eb2241ee6a039d8026b7a7..8c9901fc0152212058658038beaa5b7c7a4d372b 100644
--- a/js/creation.js
+++ b/js/creation.js
@@ -1,73 +1,116 @@
 import { powerToDamage, accuracyToRPG, ppToRPG } from "./utils.js";
 import { abilitiesData } from "./abilities.js";
 import { initAuthUI } from "./auth.js";
-import { getProfile, saveCreatedPokemon, getCreatedPokemonById } from "./storage.js";
+import { getProfile, saveCreatedPokemon } from "./storage.js";
+import { STAT_KEYS, STAT_LABELS, getRpgStatsFromPokemon, calcIntelligence, calcStrength, calcMovement, INT_LABELS, STR_LABELS, MOV_LABELS } from "./shared-pokemon.js";
 
-const STAT_KEYS = ["hp", "atk", "def", "spatk", "spdef", "spd"];
-const STAT_LABELS = { hp: "Saúde", atk: "Ataque", def: "Defesa", spatk: "Sp.Atk", spdef: "Sp.Def", spd: "Velocidade" };
 const VERSION_PRIORITY = ["scarlet-violet", "sword-shield", "ultra-sun-ultra-moon", "sun-moon"];
-const POKEBALLS = ["Poké Ball", "Great Ball", "Ultra Ball", "Premier Ball", "Luxury Ball", "Timer Ball"];
-const XP_TABLE = {1:0,2:10,3:20,4:30,5:40,6:50,7:60,8:70,9:80,10:90,11:110,12:135,13:160,14:190,15:220,16:250,17:285,18:320,19:360,20:400,21:460,22:530,23:600,24:670,25:745,26:820,27:900,28:990,29:1075,30:1165,31:1260,32:1355,33:1455,34:1555,35:1660,36:1770,37:1880,38:1995,39:2110,40:2230,41:2355,42:2480,43:2610,44:2740,45:2875,46:3015,47:3155,48:3300,49:3445,50:3645,51:3850,52:4060,53:4270,54:4485,55:4705,56:4930,57:5160,58:5390,59:5625,60:5865,61:6110,62:6360,63:6610,64:6865,65:7125,66:7390,67:7660,68:7925,69:8205,70:8485,71:8770,72:9060,73:9350,74:9645,75:9945,76:10250,77:10560,78:10870,79:11185,80:11505,81:11910,82:12320,83:12735,84:13155,85:13580,86:14010,87:14445,88:14885,89:15330,90:15780,91:16235,92:16695,93:17160,94:17630,95:18105,96:18585,97:19070,98:19560,99:20055,100:20555};
-const NATURES = [["Hardy",null,null,"Estoica","Neutra"],["Lonely","atk","def","Desesperada","Gosta de Picante e não gosta de Azedo"],["Brave","atk","spd","Travessa","Gosta de Picante e não gosta de Doce"],["Adamant","atk","spatk","Solitária","Gosta de Picante e não gosta de Seco"],["Naughty","atk","spdef","Firme","Gosta de Picante e não gosta de Amargo"],["Bold","def","atk","Ousada","Gosta de Azedo e não gosta de Picante"],["Docile",null,null,"Dócil","Neutra"],["Relaxed","def","spd","Relaxada","Gosta de Azedo e não gosta de Doce"],["Impish","def","spatk","Orgulhosa","Gosta de Azedo e não gosta de Seco"],["Lax","def","spdef","Excêntrica","Gosta de Azedo e não gosta de Amargo"],["Timid","spd","atk","Medrosa","Gosta de Doce e não gosta de Picante"],["Hasty","spd","def","Apressada","Gosta de Doce e não gosta de Azedo"],["Serious",null,null,"Séria","Neutra"],["Jolly","spd","spatk","Alegre","Gosta de Doce e não gosta de Seco"],["Naive","spd","spdef","Ingênua","Gosta de Doce e não gosta de Amargo"],["Modest","spatk","atk","Tímida","Gosta de Seco e não gosta de Picante"],["Mild","spatk","def","Modesta","Gosta de Seco e não gosta de Azedo"],["Quiet","spatk","spd","Quieta","Gosta de Seco e não gosta de Doce"],["Bashful",null,null,"Comedida","Neutra"],["Rash","spatk","spdef","Amável","Gosta de Seco e não gosta de Amargo"],["Calm","spdef","atk","Enjoada","Gosta de Amargo e não gosta de Picante"],["Gentle","spdef","def","Calma","Gosta de Amargo e não gosta de Azedo"],["Sassy","spdef","spd","Atrevida","Gosta de Amargo e não gosta de Doce"],["Careful","spdef","spatk","Gentil","Gosta de Amargo e não gosta de Seco"],["Quirky",null,null,"Chata","Neutra"]].map(([name,plus,minus,pt,taste])=>({name,plus,minus,pt,taste})).sort((a,b)=>(a.plus||"zzz").localeCompare(b.plus||"zzz"));
+const POKEBALLS = ["pokeball", "great-ball", "ultra-ball", "premier-ball", "luxury-ball", "timer-ball"];
+const NATURES = [["Hardy",null,null,"Estoica","Neutra"],["Lonely","atk","def","Desesperada","Gosta de Picante e não gosta de Azedo"],["Brave","atk","spd","Travessa","Gosta de Picante e não gosta de Doce"],["Adamant","atk","spatk","Solitária","Gosta de Picante e não gosta de Seco"],["Naughty","atk","spdef","Firme","Gosta de Picante e não gosta de Amargo"],["Bold","def","atk","Ousada","Gosta de Azedo e não gosta de Picante"],["Docile",null,null,"Dócil","Neutra"],["Relaxed","def","spd","Relaxada","Gosta de Azedo e não gosta de Doce"],["Impish","def","spatk","Orgulhosa","Gosta de Azedo e não gosta de Seco"],["Lax","def","spdef","Excêntrica","Gosta de Azedo e não gosta de Amargo"],["Timid","spd","atk","Medrosa","Gosta de Doce e não gosta de Picante"],["Hasty","spd","def","Apressada","Gosta de Doce e não gosta de Azedo"],["Serious",null,null,"Séria","Neutra"],["Jolly","spd","spatk","Alegre","Gosta de Doce e não gosta de Seco"],["Naive","spd","spdef","Ingênua","Gosta de Doce e não gosta de Amargo"],["Modest","spatk","atk","Tímida","Gosta de Seco e não gosta de Picante"],["Mild","spatk","def","Modesta","Gosta de Seco e não gosta de Azedo"],["Quiet","spatk","spd","Quieta","Gosta de Seco e não gosta de Doce"],["Bashful",null,null,"Comedida","Neutra"],["Rash","spatk","spdef","Amável","Gosta de Seco e não gosta de Amargo"],["Calm","spdef","atk","Enjoada","Gosta de Amargo e não gosta de Picante"],["Gentle","spdef","def","Calma","Gosta de Amargo e não gosta de Azedo"],["Sassy","spdef","spd","Atrevida","Gosta de Amargo e não gosta de Doce"],["Careful","spdef","spatk","Gentil","Gosta de Amargo e não gosta de Seco"],["Quirky",null,null,"Chata","Neutra"]].map(([name,plus,minus,pt,taste])=>({name,plus,minus,pt,taste}));
+const XP_TABLE={1:0,2:10,3:20,4:30,5:40,6:50,7:60,8:70,9:80,10:90,11:110,12:135,13:160,14:190,15:220,16:250,17:285,18:320,19:360,20:400,21:460,22:530,23:600,24:670,25:745,26:820,27:900,28:990,29:1075,30:1165,31:1260,32:1355,33:1455,34:1555,35:1660,36:1770,37:1880,38:1995,39:2110,40:2230,41:2355,42:2480,43:2610,44:2740,45:2875,46:3015,47:3155,48:3300,49:3445,50:3645,51:3850,52:4060,53:4270,54:4485,55:4705,56:4930,57:5160,58:5390,59:5625,60:5865,61:6110,62:6360,63:6610,64:6865,65:7125,66:7390,67:7660,68:7925,69:8205,70:8485,71:8770,72:9060,73:9350,74:9645,75:9945,76:10250,77:10560,78:10870,79:11185,80:11505,81:11910,82:12320,83:12735,84:13155,85:13580,86:14010,87:14445,88:14885,89:15330,90:15780,91:16235,92:16695,93:17160,94:17630,95:18105,96:18585,97:19070,98:19560,99:20055,100:20555};
+
+const $=(id)=>document.getElementById(id);
+const state={mode:"wild",pokemon:null,species:null,index:[],movesByLevel:[],movesByOther:[],selectedLevel:[],selectedOther:[],selectedAbilities:[],selectedGender:"",selectedBall:"",nature:NATURES[0],xp:40,shiny:false,alpha:false,loyalty:0,imageCrop:{src:"",zoom:1,x:0,y:0},manualAlloc:{hp:0,atk:0,def:0,spatk:0,spdef:0,spd:0},typeCache:null,moveCache:new Map()};
+
+const formatName=(v)=>v.split("-").map((x)=>x.charAt(0).toUpperCase()+x.slice(1)).join(" ");
+const level=()=>Math.max(1,Math.min(100,Number($("levelInput").value)||1));
+const hasCustomImage=()=>Boolean(state.imageCrop.src);
+
+async function fetchIndex(){const r=await fetch("https://pokeapi.co/api/v2/pokemon?limit=1025").then(x=>x.json());state.index=r.results.map((p,i)=>({id:i+1,name:p.name}));}
+function setupSearch(){const input=$("speciesSearch");input.addEventListener("input",()=>{const q=input.value.trim().toLowerCase(),w=$("speciesPreview");w.innerHTML="";if(!q)return;state.index.filter((p)=>p.name.includes(q)||String(p.id).startsWith(q)).slice(0,20).forEach((p)=>{const b=document.createElement("button");b.className="preview-item";b.type="button";b.innerHTML=`<img src='https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${p.id}.png' alt=''><span>#${String(p.id).padStart(4,"0")} ${formatName(p.name)}</span>`;b.onclick=()=>loadSpecies(String(p.id));w.appendChild(b);});});$("speciesSearchBtn").onclick=()=>loadSpecies(input.value.trim().toLowerCase());}
+
+async function loadSpecies(idOrName){
+  if(!idOrName)return;
+  const pokemon=await fetch(`https://pokeapi.co/api/v2/pokemon/${idOrName}`).then(r=>r.json());
+  const species=await fetch(pokemon.species.url).then(r=>r.json());
+  state.pokemon=pokemon;state.species=species;state.selectedLevel=[];state.selectedOther=[];state.selectedAbilities=[];state.manualAlloc={hp:0,atk:0,def:0,spatk:0,spdef:0,spd:0};state.selectedGender=species.gender_rate===-1?"asexual":"";state.xp=XP_TABLE[5];$("levelInput").value=5;
+  $("basicControls").hidden=false;$("natureBlock").hidden=false;$("movesSection").hidden=false;$("sheetEmpty").hidden=true;$("sheetContent").hidden=false;
+  buildNature();buildLoyalty();buildGenderMenu();await buildMovePools();renderMoveOptions();await renderRelations();render();
+}
+
+function setupModes(){document.querySelectorAll(".mode-btn").forEach((btn)=>btn.onclick=()=>{state.mode=btn.dataset.mode;document.querySelectorAll(".mode-btn").forEach((x)=>x.classList.toggle("active",x===btn));$("nicknameWrap").hidden=state.mode!=="trained";$("xpControls").hidden=state.mode!=="trained";$("ballWrap").hidden=state.mode!=="trained";$("loyaltyWrap").hidden=state.mode!=="trained";render();});}
+function buildNature(){const s=$("natureSelect");s.innerHTML="";NATURES.forEach((n)=>s.add(new Option(`${n.pt} (${n.name})`,n.name)));s.value=state.nature.name;s.onchange=()=>{state.nature=NATURES.find((x)=>x.name===s.value)||NATURES[0];render();};}
+function buildLoyalty(){const w=$("loyaltyBlocks");w.innerHTML="";for(let i=1;i<=4;i++){const b=document.createElement("button");b.className=`loyalty-block ${i<=state.loyalty?"active":""}`;b.type="button";b.textContent=i<=state.loyalty?"■":"□";b.onclick=()=>{state.loyalty=(state.loyalty===i?i-1:i);buildLoyalty();render();};w.appendChild(b);}}
+function buildGenderMenu(){const m=$("genderMenu"),btn=$("genderDropdownBtn");m.innerHTML="";btn.classList.remove("gender-male","gender-female","gender-asexual");if(state.species?.gender_rate===-1){state.selectedGender="asexual";btn.textContent="Gênero: Assexual";btn.disabled=true;btn.classList.add("gender-asexual");return;}btn.disabled=false;[["male","Masculino","assets/icons/male.png"],["female","Feminino","assets/icons/female.png"]].forEach(([g,l,icon])=>{const b=document.createElement("button");b.type="button";b.innerHTML=`<img src='${icon}' width='14' alt=''>${l}`;b.onclick=()=>{state.selectedGender=g;btn.textContent=`Gênero: ${l}`;closeGender();render();};m.appendChild(b);});btn.textContent=state.selectedGender?`Gênero: ${state.selectedGender==="male"?"Masculino":"Feminino"}`:"Gênero: —";btn.classList.add(state.selectedGender==="male"?"gender-male":state.selectedGender==="female"?"gender-female":"gender-asexual");}
+const openGender=()=>{$("genderMenu").classList.remove("hidden");$("genderDropdownBtn").setAttribute("aria-expanded","true");}; const closeGender=()=>{$("genderMenu").classList.add("hidden");$("genderDropdownBtn").setAttribute("aria-expanded","false");};
+
+async function buildMovePools(){state.movesByLevel=[];state.movesByOther=[];for(const m of state.pokemon.moves){const v=[...m.version_group_details].sort((a,b)=>VERSION_PRIORITY.indexOf(a.version_group.name)-VERSION_PRIORITY.indexOf(b.version_group.name))[0];if(!v)continue;const item={name:m.move.name,url:m.move.url,level:v.level_learned_at,method:v.move_learn_method.name};if(v.move_learn_method.name==="level-up")state.movesByLevel.push(item);if(["machine","tutor","egg"].includes(v.move_learn_method.name))state.movesByOther.push(item);}state.movesByLevel.sort((a,b)=>a.level-b.level);}
+function renderMoveOptions(){const lv=level(),ls=$("levelMoveSelect"),ts=$("tmMoveSelect");ls.innerHTML="";ts.innerHTML="";state.movesByLevel.filter((m)=>m.level<=lv).forEach((m)=>ls.add(new Option(`Lv.${m.level} ${formatName(m.name)}`,m.name)));state.movesByOther.forEach((m)=>ts.add(new Option(`${formatName(m.name)} (${m.method})`,m.name)));}
+function ensureAlphaMove(){if(!state.alpha)return;const forced=state.movesByLevel[state.movesByLevel.length-1]?.name;if(!forced)return;if(!state.selectedLevel.includes(forced)){if(state.selectedLevel.length>=4)state.selectedLevel[3]=forced;else state.selectedLevel.push(forced);}}
+
+function rankByBasal(base){return [...STAT_KEYS].sort((a,b)=>base[b]-base[a]||STAT_KEYS.indexOf(a)-STAT_KEYS.indexOf(b));}
+function wildAutoAllocation(base,points){const rank=rankByBasal(base);const gain={hp:0,atk:0,def:0,spatk:0,spdef:0,spd:0};let i=0;while(points>0){gain[rank[i%rank.length]]+=1;i++;points--;}return gain;}
+function usedPoints(){return Object.values(state.manualAlloc).reduce((a,b)=>a+b,0);} 
+
+function getComputedStats(){
+  const base=getRpgStatsFromPokemon(state.pokemon);
+  const growth=Math.floor(level()/10);
+  const levelPoints=Math.max(0,level()-1);
+  let gained=state.mode==="trained"?{...state.manualAlloc}:wildAutoAllocation(base,levelPoints);
+  if(state.mode==="trained") STAT_KEYS.forEach((k)=>{if(gained[k]<0)gained[k]=0;});
+  const final={};
+  STAT_KEYS.forEach((k)=>final[k]=base[k]+growth+gained[k]);
+  if(state.nature.plus) final[state.nature.plus]+=2;
+  if(state.nature.minus) final[state.nature.minus]-=2;
+  if(state.alpha){const rk=rankByBasal(base);final[rk[0]]+=5;final[rk[1]]+=5;}
+  return {base,gained,final,levelPoints};
+}
+
+function spriteSource(){if(hasCustomImage())return state.imageCrop.src;if(state.shiny)return state.pokemon.sprites.other["official-artwork"].front_shiny||state.pokemon.sprites.front_shiny||state.pokemon.sprites.other["official-artwork"].front_default;return state.pokemon.sprites.other["official-artwork"].front_default||state.pokemon.sprites.front_default;}
+function renderTypeBlocks(el,types){el.innerHTML="";types.forEach((t)=>{const i=document.createElement("img");i.src=`assets/types name/${t}.png`;i.onerror=()=>i.src=`assets/types/${t}.png`;i.alt=t;el.appendChild(i);});}
+async function renderRelations(){if(!state.typeCache){const data=await fetch("https://pokeapi.co/api/v2/type").then(r=>r.json());const map={};await Promise.all(data.results.map(async(t)=>map[t.name]= (await fetch(t.url).then(r=>r.json())).damage_relations));state.typeCache=map;}const mult={};Object.keys(state.typeCache).forEach((k)=>mult[k]=1);state.pokemon.types.forEach((t)=>{state.typeCache[t.type.name].double_damage_from.forEach((x)=>mult[x.name]*=2);state.typeCache[t.type.name].half_damage_from.forEach((x)=>mult[x.name]*=.5);state.typeCache[t.type.name].no_damage_from.forEach((x)=>mult[x.name]=0);});[["weaknesses",2],["resistances",0.5],["immunities",0]].forEach(([id,val])=>{const el=$(id);el.innerHTML="";Object.entries(mult).filter(([,m])=>m===val).forEach(([n])=>{const i=document.createElement("img");i.src=`assets/types name/${n}.png`;i.onerror=()=>i.src=`assets/types/${n}.png`;i.alt=n;el.appendChild(i);});});}
+
+function renderAbilities(){const b=$("abilitiesModalBody"),max=level()>=40?2:1;b.innerHTML=`<p>${max===2?"Nível >= 40: selecione até 2 habilidades.":"Nível < 40: selecione 1 habilidade."}</p>`;(state.pokemon.abilities||[]).forEach((a)=>{const key=a.ability.name;const data=abilitiesData[key];const idx=state.selectedAbilities.indexOf(key);const card=document.createElement("button");card.type="button";card.className=`ability-option ${idx===0?"selected-1":""} ${idx===1?"selected-2":""} ${a.is_hidden?"hidden-ability":""}`;card.innerHTML=`<strong>${data?.ptName||formatName(key)}${a.is_hidden?" (oculta)":""}</strong><p>${data?.effect||"Sem descrição"}</p>`;card.onclick=()=>{if(state.selectedAbilities.includes(key)) state.selectedAbilities=state.selectedAbilities.filter((x)=>x!==key); else {state.selectedAbilities.push(key); if(state.selectedAbilities.length>max) state.selectedAbilities=state.selectedAbilities.slice(-max);}renderAbilities();render();};b.appendChild(card);});}
+function renderSelectedAbilities(){const names=state.selectedAbilities.map((k)=>{const i=abilitiesData[k];const hidden=state.pokemon.abilities.find((x)=>x.ability.name===k)?.is_hidden;return `<div class='info-row'>${i?.ptName||formatName(k)}${hidden?" (oculta)":""}</div>`;});$("selectedAbilitiesView").innerHTML=names.join("");}
+
+function xpProgress(){const lv=level();const curr=XP_TABLE[lv]??0,next=XP_TABLE[Math.min(100,lv+1)]??curr;const pct=lv>=100?100:Math.max(0,Math.min(100,((state.xp-curr)/Math.max(1,next-curr))*100));return {pct,curr,next};}
+function applyXp(){let lv=level();while(lv<100 && state.xp >= (XP_TABLE[lv+1]??Infinity)) lv++;$("levelInput").value=lv;}
 
-const $ = (id) => document.getElementById(id);
-const state = { mode:"wild", pokemonIndex:[], pokemon:null, species:null, movesByLevel:[], movesByOther:[], moveCache:new Map(), selectedLevel:[], selectedOther:[], selectedAbilities:[], selectedGender:"", loyalty:0, shiny:false, alpha:false, nature:NATURES[0], xp:0, selectedBall:"", movesPt:[], muffins:0, imageCrop:{zoom:100,x:50,y:50,src:""} };
-const formatName = (v) => v.split("-").map((x)=>x[0].toUpperCase()+x.slice(1)).join(" ");
-const convertStat = (v) => (v % 10 >= 9 ? Math.floor(v / 10) + 1 : Math.floor(v / 10));
-
-function setupMenu(){const b=$("logoMenuBtn"),m=$("sideMenu"),bd=$("sideMenuBackdrop");b?.addEventListener("click",()=>{m?.classList.add("open");bd?.classList.remove("hidden");});bd?.addEventListener("click",()=>{m?.classList.remove("open");bd?.classList.add("hidden");});}
-
-async function fetchIndex(){const r=await fetch("https://pokeapi.co/api/v2/pokemon?limit=1025").then(x=>x.json());state.pokemonIndex=r.results.map((p,i)=>({id:i+1,name:p.name}));}
-function setupModes(){document.querySelectorAll(".mode-btn").forEach((btn)=>btn.addEventListener("click",()=>{state.mode=btn.dataset.mode;document.querySelectorAll(".mode-btn").forEach((x)=>x.classList.toggle("active",x===btn));$("generationControls").hidden=state.mode!=="generation";$("nicknameWrap").hidden=state.mode==="wild";$("loyaltyWrap").hidden=state.mode==="wild";$("ballWrap").hidden=state.mode!=="trained";$("xpControls").hidden=state.mode!=="trained";render();}));}
-function setupSearch(){const input=$("speciesSearch");input.addEventListener("input",updatePreview);$("speciesSearchBtn").addEventListener("click",()=>loadSpecies(input.value.trim().toLowerCase()));}
-function updatePreview(){const q=$("speciesSearch").value.trim().toLowerCase(),wrap=$("speciesPreview");wrap.innerHTML="";if(!q)return;state.pokemonIndex.filter((p)=>p.name.includes(q)||String(p.id).startsWith(q)).slice(0,20).forEach((p)=>{const btn=document.createElement("button");btn.className="preview-item";btn.type="button";btn.innerHTML=`<img src="https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/${p.id}.png" alt=""><span>#${String(p.id).padStart(4,"0")} ${formatName(p.name)}</span>`;btn.onclick=()=>{$("speciesSearch").value=p.name;wrap.innerHTML="";loadSpecies(String(p.id));};wrap.appendChild(btn);});}
-
-async function loadSpecies(idOrName){if(!idOrName)return;const pokemon=await fetch(`https://pokeapi.co/api/v2/pokemon/${idOrName}`).then(r=>r.json());const species=await fetch(pokemon.species.url).then(r=>r.json());state.pokemon=pokemon;state.species=species;state.selectedLevel=[];state.selectedOther=[];state.selectedAbilities=[];state.selectedGender="";state.loyalty=0;state.xp=XP_TABLE[Number($("levelInput").value)||1]||0;state.imageCrop={zoom:100,x:50,y:50,src:""};$("sheetEmpty").hidden=true;$("sheetContent").hidden=false;$("basicControls").hidden=false;$("natureBlock").hidden=false;$("movesSection").hidden=false;buildGenderMenu();buildLoyalty();buildNature();buildBalls();await buildMovePools();renderMoveOptions();render();}
-
-function buildNature(){const sel=$("natureSelect");sel.innerHTML="";NATURES.forEach((n)=>{const o=document.createElement("option");const plus=n.plus?`+2 ${STAT_LABELS[n.plus]}`:"neutra";const minus=n.minus?`-2 ${STAT_LABELS[n.minus]}`:"";o.value=n.name;o.textContent=`${n.pt} ${plus} ${minus}`;sel.appendChild(o);});sel.onchange=()=>{state.nature=NATURES.find((n)=>n.name===sel.value)||NATURES[0];render();};state.nature=NATURES[0];}
-function buildLoyalty(){const wrap=$("loyaltyBlocks");wrap.innerHTML="";for(let i=1;i<=4;i++){const b=document.createElement("button");b.type="button";b.className="loyalty-block";b.textContent=i<=state.loyalty?"■":"□";b.onclick=()=>{state.loyalty=i;buildLoyalty();render();};wrap.appendChild(b);}if(state.loyalty===0){[...wrap.children].forEach((c)=>c.textContent="□");}}
-function buildGenderMenu(){const menu=$("genderMenu"),btn=$("genderDropdownBtn");if(state.species?.gender_rate===-1){btn.textContent="Gênero: assexual";btn.disabled=true;menu.innerHTML="";return;}btn.disabled=false;menu.innerHTML="<button type='button' data-g='male'><img src='assets/icons/male.png' width='14'> Masculino</button><button type='button' data-g='female'><img src='assets/icons/female.png' width='14'> Feminino</button>";btn.onclick=()=>menu.classList.toggle("hidden");menu.querySelectorAll("button").forEach((b)=>b.onclick=()=>{state.selectedGender=b.dataset.g;btn.textContent=`Gênero: ${b.dataset.g==="male"?"Masculino":"Feminino"}`;menu.classList.add("hidden");render();});}
-function buildBalls(){const wrap=$("pokeballGrid");wrap.innerHTML="";POKEBALLS.forEach((name)=>{const slug=name.toLowerCase().replace(/\s+/g,"-");const img=`assets/pokeball/${slug}.png`;const btn=document.createElement("button");btn.type="button";btn.className=`pokeball-item ${state.selectedBall===slug?"active":""}`;btn.innerHTML=`<img src="${img}" onerror="this.style.display='none'" alt="${name}"><span>${name}</span>`;btn.onclick=()=>{state.selectedBall=slug;buildBalls();render();};wrap.appendChild(btn);});}
-
-function level(){return Math.max(1,Math.min(100,Number($("levelInput").value)||1));}
-function isLegendary(){return Boolean(state.species?.is_legendary||state.species?.is_mythical);} 
-function getBaseStats(){const raw={};state.pokemon.stats.forEach((s)=>raw[s.stat.name]=s.base_stat);return {hp:convertStat(raw.hp),atk:convertStat(raw.attack),def:convertStat(raw.defense),spatk:convertStat(raw["special-attack"]),spdef:convertStat(raw["special-defense"]),spd:convertStat(raw.speed)};}
-function getFinalStats(base){const lv=level();const growth=Math.floor(lv/10);const out={};STAT_KEYS.forEach((k)=>{out[k]=base[k]+growth+(state.nature.plus===k?2:0)-(state.nature.minus===k?2:0);});return out;}
-function captureChance(){if(state.mode!=="wild")return null;let c=100-Math.floor(level()/2);c+=0;const hpPct=100;if(hpPct>51)c-=30;const hasNext=Boolean(state.species?.evolves_from_species)||Boolean(state.species?.evolution_chain?.url);c+=hasNext?0:-10;if(state.shiny)c-=10;if(state.alpha)c-=20;if(isLegendary())c-=30;return Math.max(1,c);}
-
-function renderTypeBlocks(el, types){el.innerHTML="";types.forEach((t)=>{const img=document.createElement("img");img.src=`assets/types block/${t}.png`;img.alt=t;img.onerror=()=>img.src=`assets/types/${t}.png`;el.appendChild(img);});}
-async function renderRelations(){const data=await fetch("https://pokeapi.co/api/v2/type").then(r=>r.json());const map={};await Promise.all(data.results.map(async(t)=>{const d=await fetch(t.url).then(r=>r.json());map[t.name]=d.damage_relations;}));const mult={};Object.keys(map).forEach((k)=>mult[k]=1);state.pokemon.types.forEach((t)=>{map[t.type.name].double_damage_from.forEach((x)=>mult[x.name]*=2);map[t.type.name].half_damage_from.forEach((x)=>mult[x.name]*=.5);map[t.type.name].no_damage_from.forEach((x)=>mult[x.name]=0);});const put=(id,val)=>{const el=$(id);el.innerHTML="";Object.entries(mult).filter(([,m])=>m===val).forEach(([n])=>{const i=document.createElement("img");i.src=`assets/types block/${n}.png`;i.alt=n;i.onerror=()=>i.src=`assets/types/${n}.png`;el.appendChild(i);});};put("weaknesses",2);put("resistances",0.5);put("immunities",0);}
-
-const pickVersion=(arr)=>[...arr].sort((a,b)=>VERSION_PRIORITY.indexOf(a.version_group.name)-VERSION_PRIORITY.indexOf(b.version_group.name))[0];
 async function getMove(url){if(state.moveCache.has(url))return state.moveCache.get(url);const d=await fetch(url).then(r=>r.json());state.moveCache.set(url,d);return d;}
-async function buildMovePools(){state.movesByLevel=[];state.movesByOther=[];for(const m of state.pokemon.moves){const v=pickVersion(m.version_group_details);if(!v)continue;const obj={name:m.move.name,url:m.move.url,level:v.level_learned_at,method:v.move_learn_method.name};if(v.move_learn_method.name==="level-up")state.movesByLevel.push(obj);else state.movesByOther.push(obj);}state.movesByLevel.sort((a,b)=>a.level-b.level);}
-function renderMoveOptions(){const lv=level();const ls=$("levelMoveSelect"),ts=$("tmMoveSelect");ls.innerHTML="";ts.innerHTML="";state.movesByLevel.filter((m)=>m.level<=lv).forEach((m)=>ls.add(new Option(`Lv.${m.level} ${formatName(m.name)}`,m.name)));state.movesByOther.slice(0,300).forEach((m)=>ts.add(new Option(formatName(m.name),m.name)));}
-function moveTypeColor(type){const c={fire:"#f08030",water:"#6890f0",grass:"#78c850",electric:"#f8d030",normal:"#a8a878",dark:"#705848",psychic:"#f85888",ice:"#98d8d8",fighting:"#c03028",poison:"#a040a0",ground:"#e0c068",flying:"#a890f0",bug:"#a8b820",rock:"#b8a038",ghost:"#705898",dragon:"#7038f8",steel:"#b8b8d0",fairy:"#ee99ac"};return c[type]||"#7bdc65";}
-async function renderSelectedMoves(){const out=$("selectedMovesOutput");out.innerHTML="";for(const name of [...state.selectedLevel,...state.selectedOther]){const e=state.movesByLevel.find((m)=>m.name===name)||state.movesByOther.find((m)=>m.name===name);if(!e)continue;const d=await getMove(e.url);const li=document.createElement("li");const c=moveTypeColor(d.type.name);li.className="move-chip";li.style.background=`${c}22`;li.style.borderColor=`${c}88`;li.textContent=formatName(name);li.onclick=()=>openMoveModal(name);out.appendChild(li);}[$("levelMoveSlots"),$("tmMoveSlots")].forEach((el,i)=>{const arr=i===0?state.selectedLevel:state.selectedOther;el.innerHTML="";arr.forEach((m)=>{const li=document.createElement("li");li.textContent=formatName(m);li.onclick=()=>openMoveModal(m);el.appendChild(li);});});}
-
-async function openMoveModal(moveName){const entry=[...state.movesByLevel,...state.movesByOther].find((m)=>m.name===moveName);if(!entry)return;const m=await getMove(entry.url);const c=moveTypeColor(m.type.name);const desc=m.effect_entries.find((x)=>x.language.name==="en")?.effect||"Sem descrição";$("moveModalTitle").textContent=formatName(moveName);$("moveDetailsBody").innerHTML=`<div class='move-modal-shell' style='border-color:${c}'><div class='move-details-title'>${formatName(moveName)}</div><p style='text-align:center'><img src='assets/types/${m.type.name}.png' width='24'> ${formatName(m.type.name)}</p><div class='move-details-grid'><div><img src='assets/icons/${m.damage_class.name}.png' width='24'><br>${formatName(m.damage_class.name)}</div><div>ACC<br><strong>${accuracyToRPG(m.accuracy||100)}</strong></div><div>PP<br><strong>${ppToRPG(m.pp||0)}</strong></div></div><p>Dano RPG: <strong>${powerToDamage(m.power)}</strong></p><section><h4>Descrição</h4><p>${desc}</p></section></div>`;$("moveDetailsModal").showModal();}
-
-function renderAbilities(){const body=$("abilitiesModalBody");const limit=level()>=40?2:1;body.innerHTML=limit>1?"<p>Seu nível permite escolher uma segunda habilidade.</p>":"";state.pokemon.abilities.forEach((a)=>{const info=abilitiesData[a.ability.name]||{ptName:formatName(a.ability.name),name:formatName(a.ability.name),activation:"—",effect:"—"};const idx=state.selectedAbilities.indexOf(a.ability.name);const div=document.createElement("div");div.className=`ability-option ${idx===0?"selected-1":""} ${idx===1?"selected-2":""} ${a.is_hidden?"hidden-ability":""}`;div.innerHTML=`<strong>${info.ptName} (${info.name}) ${a.is_hidden?"<span style='color:#aaa'>(oculta)</span>":""}</strong><p>Ativação: ${info.activation}</p><p>Efeito: ${info.effect}</p>`;div.onclick=()=>{if(idx>=0){state.selectedAbilities.splice(idx,1);}else if(state.selectedAbilities.length<limit){state.selectedAbilities.push(a.ability.name);}else{state.selectedAbilities[limit-1]=a.ability.name;}renderAbilities();render();};body.appendChild(div);});}
-
-function renderStatsCompact(base, final){const col=(title,keyGetter)=>`<div class='stats-col'><strong>${title}</strong><ul>${STAT_KEYS.map((k)=>`<li><span>${STAT_LABELS[k]}</span><span>${keyGetter(k)}</span></li>`).join("")}</ul></div>`;$("statsCompact").innerHTML=col("Basal",(k)=>base[k])+col("Pontos",()=>Math.floor(level()/10))+col("Final",(k)=>final[k]);}
-function renderCapacities(final){const int=Math.min(4,Math.floor((final.spatk+final.spdef)/4));const str=Math.min(4,Math.floor((final.atk+final.def)/4));const mov=Math.min(4,Math.floor(final.spd/2));$("cap-int").textContent=int;$("cap-str").textContent=str;$("cap-mov").textContent=mov;$("cap-int-label").textContent=["Instintivo","Observador","Sagaz","Brilhante","Gênio"][int];$("cap-str-label").textContent=["Frágil","Subdesenvolvida","Treinada","Potente","Colossal"][str];$("cap-mov-label").textContent=["Lento","Ágil","Veloz","Relâmpago","Supersônico"][mov];}
-function renderXP(){const lv=level();const min=XP_TABLE[lv],max=XP_TABLE[Math.min(100,lv+1)]||XP_TABLE[100];const pct=max===min?100:Math.max(0,Math.min(100,((state.xp-min)/(max-min))*100));$("xpBarFill").style.width=`${pct}%`;$("xpBarText").textContent=`XP ${state.xp} (${min} → ${max})`;}
-function tryLevelUp(){let lv=level();let ups=[];while(lv<100&&state.xp>=XP_TABLE[lv+1]){lv++;ups.push(lv);}if(ups.length){$("levelInput").value=lv;const learned=state.movesByLevel.filter((m)=>ups.includes(m.level)).map((m)=>formatName(m.name));alert(`Subiu para nível ${lv}. Ganhou +1 ponto por nível.${learned.length?` Aprendeu: ${learned.join(", ")}`:""}`);renderMoveOptions();}}
-
-function renderInfoTab(){const p=state.pokemon;const types=p.types.map((t)=>t.type.name);const female=state.species.gender_rate===-1?"assexual":`${state.species.gender_rate*12.5}%♀`;const loyaltyTxt=["Sem vínculo","Conhece você","Confia em você","Leal","Parceiro total"][state.loyalty]||"Sem vínculo";const loy=`${"■".repeat(state.loyalty)}${"□".repeat(4-state.loyalty)}`;$("infoContent").innerHTML=`<div class='info-row'><strong>Proporções:</strong> ${p.height/10}m | ${p.weight/10}kg</div><div class='info-row'><strong>Reprodução:</strong> ${female} | ${state.species.egg_groups.map((g)=>g.name).join(" | ")}</div><div class='info-row'><strong>Natureza:</strong> ${state.nature.pt} — ${state.nature.taste}</div><div class='info-row'><strong>Modo:</strong> ${state.mode==="wild"?"Selvagem":"Adestrado"}</div>${state.mode==="wild"?`<div class='info-row'><strong>Chance de captura:</strong> ${captureChance()}%</div><div class='info-row'><strong>XP dado:</strong> ${level()}</div>`:""}${state.mode!=="wild"?`<div class='info-row'><strong>Lealdade:</strong> ${loy}<br>${loyaltyTxt}</div>`:""}`;}
-
-function render(){if(!state.pokemon)return;const p=state.pokemon,base=getBaseStats(),final=getFinalStats(base);const displayName=state.mode==="trained"&&$("nicknameInput").value.trim()?$("nicknameInput").value.trim():formatName(p.name);$("sheetName").textContent=displayName;$("sheetSpeciesSub").textContent=displayName!==formatName(p.name)?formatName(p.name):"";$("sheetDex").textContent=`#${String(p.id).padStart(4,"0")}`;$("sheetLevel").textContent=`Nv.${level()}`;$("sheetModeLabel").textContent=state.mode==="wild"?"Pokémon Selvagem":"Pokémon Adestrado";const art=state.imageCrop.src||p.sprites.other["official-artwork"].front_default||p.sprites.front_default;$("sheetSprite").src=art;$("sheetSprite").style.objectFit=state.imageCrop.src?"cover":"contain";if(state.imageCrop.src){$("sheetSprite").style.objectPosition=`${state.imageCrop.x}% ${state.imageCrop.y}%`;$("sheetSprite").style.transform=`scale(${state.imageCrop.zoom/100})`;}const t1=p.types[0]?.type.name||"normal";$("sheetImageButton").style.borderColor=moveTypeColor(t1);renderTypeBlocks($("sheetTypes"),p.types.map((t)=>t.type.name));$("sheetBadges").innerHTML=`${state.shiny?"<img class='badge-icon' src='assets/forms/shiny.png'>":""}${state.alpha?"<img class='badge-icon' src='assets/icons/alpha.png'>":""}`;$("sheetBallIcon").innerHTML=state.mode==="trained"&&state.selectedBall?`<img class='badge-icon' src='assets/pokeball/${state.selectedBall}.png' onerror="this.style.display='none'">`:"";renderStatsCompact(base,final);renderCapacities(final);$("hp1Fill").style.width="100%";$("hp2Fill").style.width="100%";$("hp1Text").textContent=`${final.hp*10}`;$("hp2Text").textContent=`${final.hp*5}`;renderXP();renderInfoTab();renderSelectedMoves();renderRelations();}
-
-function setupEvents(){document.querySelectorAll("[data-close-modal]").forEach((b)=>b.onclick=()=>$(b.dataset.closeModal).close());$("openAbilitiesModalBtn").onclick=()=>{renderAbilities();$("abilitiesModal").showModal();};$("addLevelMoveBtn").onclick=()=>{const v=$("levelMoveSelect").value;if(!v||state.selectedLevel.includes(v)||state.selectedLevel.length>=4)return;state.selectedLevel.push(v);renderSelectedMoves();};$("addTmMoveBtn").onclick=()=>{const v=$("tmMoveSelect").value;if(!v||state.selectedOther.includes(v)||state.selectedOther.length>=4)return;state.selectedOther.push(v);renderSelectedMoves();};$("levelInput").addEventListener("input",()=>{renderMoveOptions();render();});$("nicknameInput").addEventListener("input",render);$("shinyToggle").onclick=()=>{state.shiny=!state.shiny;$("shinyToggle").classList.toggle("active",state.shiny);render();};$("alphaToggle").onclick=()=>{state.alpha=!state.alpha;$("alphaToggle").classList.toggle("active",state.alpha);render();};$("quickGenerateBtn").onclick=async()=>{const p=state.pokemonIndex[Math.floor(Math.random()*state.pokemonIndex.length)];await loadSpecies(String(p.id));$("levelInput").value=Math.floor(Math.random()*100)+1;render();};$("addXpBtn").onclick=()=>{state.xp+=Math.max(0,Number($("xpInput").value)||0);tryLevelUp();render();};$("copySheetBtn").onclick=async()=>{await navigator.clipboard.writeText(`${$("sheetDex").textContent} ${$("sheetName").textContent} ${$("sheetLevel").textContent}`);alert("Ficha copiada!");};$("copyMovesBtn").onclick=async()=>{await navigator.clipboard.writeText([...state.selectedLevel,...state.selectedOther].map(formatName).join("\n"));alert("Golpes copiados!");};$("savePokemonBtn").onclick=()=>saveCurrent();$("openStatsRadar").onclick=()=>openRadar("stats");$("openContestRadar").onclick=()=>openRadar("contest");$("sheetImageButton").onclick=()=>openImageModal();}
-
-function openRadar(type){$("radarTitle").textContent=type==="stats"?"Radar de atributos basais":"Radar de concurso";$("radarBody").innerHTML=`<canvas id='radarCanvas' width='400' height='320'></canvas>${type==="contest"?`<p>Muffins disponíveis: ${state.muffins} <button id='mPlus'>+</button> <button id='mMinus'>-</button></p>`:""}`;if(typeof Chart!=="undefined"){const base=getFinalStats(getBaseStats());const labels=STAT_KEYS.map((k)=>STAT_LABELS[k]);const data=type==="stats"?STAT_KEYS.map((k)=>base[k]):STAT_KEYS.map((k)=>Math.min(3,Math.floor((base[k]+(state.muffins*10))/10)));new Chart($("radarCanvas"),{type:"radar",data:{labels,datasets:[{data,backgroundColor:"rgba(123,220,101,.2)",borderColor:"#7bdc65"}]},options:{plugins:{legend:{display:false}}}});}if(type==="contest"){$("mPlus").onclick=()=>{state.muffins=Math.min(5,state.muffins+1);openRadar("contest");};$("mMinus").onclick=()=>{state.muffins=Math.max(0,state.muffins-1);openRadar("contest");};}$("radarModal").showModal();}
-
-function openImageModal(){if(state.mode!=="trained")return;$("cropBody").innerHTML=`<input id='imgUpload' type='file' accept='image/png,image/jpeg,image/gif'><label>Zoom <input id='cropZoom' type='range' min='80' max='180' value='${state.imageCrop.zoom}'></label><label>X <input id='cropX' type='range' min='0' max='100' value='${state.imageCrop.x}'></label><label>Y <input id='cropY' type='range' min='0' max='100' value='${state.imageCrop.y}'></label><div class='sheet-image-frame'><img id='cropPreview' src='${state.imageCrop.src||state.pokemon.sprites.other["official-artwork"].front_default}' style='object-fit:cover;object-position:${state.imageCrop.x}% ${state.imageCrop.y}%;transform:scale(${state.imageCrop.zoom/100})'></div><button id='saveCropBtn' type='button'>Salvar imagem</button>`;const sync=()=>{const z=Number($("cropZoom").value),x=Number($("cropX").value),y=Number($("cropY").value);$("cropPreview").style.objectPosition=`${x}% ${y}%`;$("cropPreview").style.transform=`scale(${z/100})`;};["cropZoom","cropX","cropY"].forEach((id)=>$(id).oninput=sync);$("imgUpload").onchange=()=>{const f=$("imgUpload").files?.[0];if(!f)return;const reader=new FileReader();reader.onload=()=>{$("cropPreview").src=String(reader.result);};reader.readAsDataURL(f);};$("saveCropBtn").onclick=()=>{state.imageCrop={zoom:Number($("cropZoom").value),x:Number($("cropX").value),y:Number($("cropY").value),src:$("cropPreview").src};$("imageCropModal").close();render();};$("imageCropModal").showModal();}
-
-function getPayload(){return {pokemonId:state.pokemon.id,pokemonName:state.pokemon.name,nickname:$("nicknameInput").value.trim(),mode:state.mode,level:level(),xp:state.xp,shiny:state.shiny,alpha:state.alpha,nature:state.nature,abilities:[...state.selectedAbilities],moves:[...state.selectedLevel,...state.selectedOther],selectedBall:state.selectedBall,loyalty:state.loyalty,gender:state.selectedGender,imageCrop:state.imageCrop,sprite:state.imageCrop.src||state.pokemon.sprites.other["official-artwork"].front_default,dex:`#${String(state.pokemon.id).padStart(4,"0")}`};}
-function saveCurrent(){const profile=getProfile();if(!profile){alert("Faça login para salvar.");return;}const saved=saveCreatedPokemon(getPayload());alert(`Salvo: ${saved.id}`);} 
-
-async function loadFromQuery(){const id=new URLSearchParams(location.search).get("id");if(!id)return;const saved=getCreatedPokemonById(id);if(!saved)return;await loadSpecies(String(saved.pokemonId));$("nicknameInput").value=saved.nickname||"";$("levelInput").value=saved.level;state.mode=saved.mode;document.querySelector(`.mode-btn[data-mode='${saved.mode}']`)?.click();state.xp=saved.xp||XP_TABLE[saved.level]||0;state.shiny=Boolean(saved.shiny);state.alpha=Boolean(saved.alpha);state.nature=saved.nature||NATURES[0];$("natureSelect").value=state.nature.name;state.selectedAbilities=saved.abilities||[];state.selectedLevel=(saved.moves||[]).filter((m)=>state.movesByLevel.find((x)=>x.name===m)).slice(0,4);state.selectedOther=(saved.moves||[]).filter((m)=>state.movesByOther.find((x)=>x.name===m)).slice(0,4);state.selectedBall=saved.selectedBall||"";state.loyalty=saved.loyalty||0;state.selectedGender=saved.gender||"";state.imageCrop=saved.imageCrop||state.imageCrop;buildLoyalty();buildBalls();render();}
-
-async function init(){setupMenu();initAuthUI();setupModes();setupSearch();setupEvents();await fetchIndex();await loadFromQuery();}
+async function renderMoveLists(){const draw=async(list,target,kind)=>{const el=$(target);el.innerHTML="";for(const [idx,name] of list.entries()){const move=(state.movesByLevel.find((m)=>m.name===name)||state.movesByOther.find((m)=>m.name===name));if(!move)continue;const d=await getMove(move.url);const baseDamage=powerToDamage(d.power||0);const isDamaging=Number(d.power)>0;const stab= isDamaging && state.pokemon.types.some((t)=>t.type.name===d.type.name) ? Math.floor(level()/5) : 0;const damageText=isDamaging?(stab>0?`${baseDamage} + ${stab}`:`${baseDamage}`):"Status";const li=document.createElement("li");li.innerHTML=`<span>${formatName(name)} — Dano ${damageText} / Acc ${accuracyToRPG(d.accuracy||100)} / PP ${ppToRPG(d.pp||0)}</span><button data-k='${kind}' data-i='${idx}' type='button'>Remover</button>`;el.appendChild(li);}el.querySelectorAll("button").forEach((b)=>b.onclick=()=>{const i=Number(b.dataset.i);if(b.dataset.k==="level")state.selectedLevel.splice(i,1);else state.selectedOther.splice(i,1);render();});};await draw(state.selectedLevel,"levelMoveSlots","level");await draw(state.selectedOther,"tmMoveSlots","tm");
+  const out=$("selectedMovesOutput");out.innerHTML="";[...state.selectedLevel,...state.selectedOther].forEach((n)=>{const li=document.createElement("li");li.textContent=formatName(n);out.appendChild(li);});
+}
+
+function renderStatsBoard(comp){const {base,gained,final,levelPoints}=comp;const trained=state.mode==="trained";const rows=[`<div class='stats-row header'><span>Atributo</span><span>Basal</span><span>Ganho Nv</span><span>Final</span></div>`];STAT_KEYS.forEach((k)=>{const clsPlus=state.nature.plus===k?"nature-plus":"";const clsMinus=state.nature.minus===k?"nature-minus":"";const control=trained?`<span class='alloc-control'><button data-stat='${k}' data-d='-1' type='button'>-</button>${gained[k]}<button data-stat='${k}' data-d='1' type='button'>+</button></span>`:`<span>${gained[k]}</span>`;rows.push(`<div class='stats-row ${clsPlus} ${clsMinus}'><span>${STAT_LABELS[k]}</span><span>${base[k]}</span>${control}<strong>${final[k]}</strong></div>`);});rows.push(`<div class='info-row'>Pontos de nível: ${trained?`${usedPoints()}/${levelPoints}`:`automático (${levelPoints})`}</div>`);$("statsBoard").innerHTML=rows.join("");if(trained){$("statsBoard").querySelectorAll(".alloc-control button").forEach((b)=>b.onclick=()=>{const st=b.dataset.stat,d=Number(b.dataset.d),limit=Math.max(0,level()-1);if(d>0 && usedPoints()>=limit)return;if(d<0 && state.manualAlloc[st]<=0)return;state.manualAlloc[st]+=d;render();});}}
+
+function render(){if(!state.pokemon)return;ensureAlphaMove();const comp=getComputedStats();const finalName=(state.alpha?"Alpha ":"") + ((state.mode==="trained" && $("nicknameInput").value.trim())?$("nicknameInput").value.trim():formatName(state.pokemon.name));
+  $("sheetSprite").src=spriteSource();
+  $("sheetDex").textContent=`#${String(state.pokemon.id).padStart(4,"0")}`;$("sheetName").textContent=finalName;$("sheetLevel").textContent=`Nv.${level()}`;$("sheetSpeciesSub").textContent=formatName(state.pokemon.name);
+  renderTypeBlocks($("sheetTypes"),state.pokemon.types.map((t)=>t.type.name));
+  const hpTotal=(comp.final.hp+level())*4;const hpQuick=level()+(comp.final.hp*3);$("hp1Text").textContent=`${hpTotal}/${hpTotal}`;$("hp2Text").textContent=`${hpQuick}/${hpQuick}`;
+  const xp=xpProgress();$("xpBarFill").style.width=`${xp.pct}%`;$("xpBarText").textContent=`XP ${state.xp} (${Math.round(xp.pct)}%)`;
+  $("sheetBallIcon").innerHTML=`${state.mode==="trained"&&state.selectedBall?`<img class='corner-icon' src='assets/pokeball/${state.selectedBall}.png' alt='pokeball'>`:""}${state.mode==="trained"&&state.loyalty>0?`<img class='corner-icon' src='assets/forms/lealdade${state.loyalty}.png' alt='lealdade'>`:""}`;
+  $("sheetBadges").innerHTML=`${state.shiny?`<img class='badge-icon' src='assets/forms/shiny.png' alt='shiny'>`:""}${state.alpha?`<img class='badge-icon' src='assets/icons/alpha.png' alt='alpha'>`:""}`;
+  renderSelectedAbilities();renderStatsBoard(comp);
+  const meta={types:state.pokemon.types.map((t)=>t.type.name),eggGroups:(state.species.egg_groups||[]).map((x)=>x.name),stats:comp.final,weight:state.pokemon.weight/10,isLegendary:Boolean(state.species.is_legendary||state.species.is_mythical),isSingleStage:false,isFinalStage:false};
+  const ci=calcIntelligence(meta),cs=calcStrength(meta),cm=calcMovement(meta);$("cap-int").textContent=ci;$("cap-int-label").textContent=INT_LABELS[ci];$("cap-str").textContent=cs;$("cap-str-label").textContent=STR_LABELS[cs];$("cap-mov").textContent=cm;$("cap-mov-label").textContent=MOV_LABELS[cm];
+  $("infoContent").innerHTML=`<div class='info-row'>Proporções: ${state.pokemon.height/10}m | ${state.pokemon.weight/10}kg</div><div class='info-row'>Reprodução: ${(state.species.egg_groups||[]).map((x)=>formatName(x.name)).join(" | ")||"—"}</div><div class='info-row'>Natureza: ${state.nature.pt}</div><div class='info-row'>Modo: ${state.mode==="trained"?"Adestrado":"Selvagem"}</div>`;
+  $("selectedBallText").textContent=state.selectedBall?formatName(state.selectedBall):"Nenhuma selecionada";
+  $("shinyToggle").classList.toggle("active",state.shiny);$("alphaToggle").classList.toggle("active",state.alpha);
+  renderMoveLists();
+}
+
+function saveCurrent(){if(!state.pokemon)return;const profile=getProfile();if(!profile){alert("Faça login para salvar.");return;}if(state.mode==="trained"){const missing=Math.max(0,(level()-1)-usedPoints());if(missing>0){alert(`Ainda faltam ${missing} pontos para distribuir.`);return;}}const payload={pokemonId:state.pokemon.id,pokemonName:state.pokemon.name,level:level(),mode:state.mode,nickname:$("nicknameInput").value.trim(),nature:state.nature,moves:[...state.selectedLevel,...state.selectedOther],abilities:[...state.selectedAbilities],shiny:state.shiny,alpha:state.alpha,xp:state.xp,selectedBall:state.selectedBall,loyalty:state.loyalty,gender:state.selectedGender,imageCrop:state.imageCrop,sprite:spriteSource()};const saved=saveCreatedPokemon(payload);alert(`Salvo: ${saved.id}`);}
+
+function setupEvents(){
+  $("levelInput").addEventListener("input",()=>{renderMoveOptions();render();});
+  $("nicknameInput").addEventListener("input",render);
+  $("shinyToggle").onclick=()=>{state.shiny=!state.shiny;render();};
+  $("alphaToggle").onclick=()=>{state.alpha=!state.alpha;render();};
+  $("addXpBtn").onclick=()=>{state.xp += Math.max(0,Number($("xpInput").value)||0);const before=level();applyXp();if(level()>before)alert(`Subiu para o nível ${level()}!`);renderMoveOptions();render();};
+  $("addLevelMoveBtn").onclick=()=>{const v=$("levelMoveSelect").value;if(!v||state.selectedLevel.includes(v)||state.selectedLevel.length>=4)return;state.selectedLevel.push(v);render();};
+  $("addTmMoveBtn").onclick=()=>{const v=$("tmMoveSelect").value;if(!v||state.selectedOther.includes(v)||state.selectedOther.length>=4)return;state.selectedOther.push(v);render();};
+  $("openAbilitiesModalBtn").onclick=()=>{renderAbilities();$("abilitiesModal").showModal();};
+  $("openPokeballModalBtn").onclick=()=>{const b=$("pokeballModalBody");b.innerHTML="";POKEBALLS.forEach((slug)=>{const bt=document.createElement("button");bt.type="button";bt.className="pokeball-item";bt.innerHTML=`<img src='assets/pokeball/${slug}.png' alt='${slug}'><span>${formatName(slug)}</span>`;bt.onclick=()=>{state.selectedBall=slug;$("pokeballModal").close();render();};b.appendChild(bt);});$("pokeballModal").showModal();};
+  $("genderDropdownBtn").onclick=()=>$("genderMenu").classList.contains("hidden")?openGender():closeGender();
+  $("genderDropdownBtn").addEventListener("keydown",(e)=>{if(e.key==="Enter"||e.key===" "){e.preventDefault();openGender();}});
+  document.addEventListener("click",(e)=>{if(!$("genderMenu").contains(e.target)&&e.target!==$("genderDropdownBtn"))closeGender();});
+  document.addEventListener("keydown",(e)=>{if(e.key==="Escape"){closeGender();document.querySelectorAll("dialog[open]").forEach((d)=>d.close());}});
+  document.querySelectorAll("[data-close-modal]").forEach((b)=>b.onclick=()=>$(b.dataset.closeModal).close());
+  $("savePokemonBtn").onclick=saveCurrent;
+}
+
+function setupImageModal(){ $("sheetImageButton").onclick=()=>{if(state.mode!=="trained"||!state.pokemon)return;const src=state.imageCrop.src||state.pokemon.sprites.other["official-artwork"].front_default;$("cropBody").innerHTML=`<input id='imgUpload' type='file' accept='image/png,image/jpeg,image/gif'><div id='cropViewer' class='crop-viewer'><img id='cropPreview' src='${src}' alt='preview'></div><button id='saveCropBtn' type='button'>Salvar imagem</button>`;const viewer=$("cropViewer"),img=$("cropPreview");let local={...state.imageCrop};const paint=()=>{img.style.transform=`translate(calc(-50% + ${local.x}px), calc(-50% + ${local.y}px)) scale(${local.zoom})`;};paint();let drag=false,sx=0,sy=0;viewer.onpointerdown=(e)=>{drag=true;sx=e.clientX;sy=e.clientY;viewer.setPointerCapture(e.pointerId);};viewer.onpointermove=(e)=>{if(!drag)return;local.x+=(e.clientX-sx);local.y+=(e.clientY-sy);sx=e.clientX;sy=e.clientY;paint();};viewer.onpointerup=()=>drag=false;viewer.onwheel=(e)=>{e.preventDefault();local.zoom=Math.min(3,Math.max(.5,(local.zoom||1)+(e.deltaY>0?-0.05:0.05)));paint();};$("imgUpload").onchange=()=>{const f=$("imgUpload").files?.[0];if(!f)return;const rd=new FileReader();rd.onload=()=>{img.src=String(rd.result);};rd.readAsDataURL(f);};$("saveCropBtn").onclick=()=>{state.imageCrop={...local,src:img.src};$("imageCropModal").close();render();};$("imageCropModal").showModal();}; }
+
+async function init(){initAuthUI();setupModes();setupSearch();setupEvents();setupImageModal();await fetchIndex();}
 init();
diff --git a/js/shared-pokemon.js b/js/shared-pokemon.js
new file mode 100644
index 0000000000000000000000000000000000000000..035997c23d58af01b562c84289b3b2e3ca66aac9
--- /dev/null
+++ b/js/shared-pokemon.js
@@ -0,0 +1,60 @@
+export const STAT_KEYS = ["hp", "atk", "def", "spatk", "spdef", "spd"];
+export const STAT_LABELS = { hp: "Saúde", atk: "Atk", def: "Def", spatk: "Sp.Atk", spdef: "Sp.Def", spd: "Spd" };
+export const INT_LABELS = ["Instintivo", "Consciente", "Racional", "Estrategista", "Gênio"];
+export const STR_LABELS = ["Frágil", "Subdesenvolvida", "Robusta", "Poderosa", "Titânica"];
+export const MOV_LABELS = ["Estático", "Lento", "Ágil", "Atlético", "Veloz"];
+
+export function convertStat(value) {
+  const base = Math.floor(value / 10);
+  return value % 10 >= 9 ? base + 1 : base;
+}
+
+export function getRpgStatsFromPokemon(pokemon) {
+  const raw = {};
+  (pokemon?.stats || []).forEach((s) => (raw[s.stat.name] = s.base_stat));
+  return {
+    hp: convertStat(raw.hp || 0),
+    atk: convertStat(raw.attack || 0),
+    def: convertStat(raw.defense || 0),
+    spatk: convertStat(raw["special-attack"] || 0),
+    spdef: convertStat(raw["special-defense"] || 0),
+    spd: convertStat(raw.speed || 0),
+  };
+}
+
+function sumFromList(list = [], rules) {
+  let total = 0;
+  for (const item of list) if (rules[item] !== undefined) total += rules[item];
+  return total;
+}
+function clampCapacity(value) { return Math.max(0, Math.min(4, value)); }
+
+export function calcIntelligence(meta) {
+  let value = 0;
+  value += sumFromList(meta.types, { psychic: 2, fighting: 1, ghost: 1, fairy: 1, dark: 1, bug: -1, rock: -1, ground: -1, ice: -1, normal: -1 });
+  value += sumFromList(meta.eggGroups, { humanshape: 1, amorphous: 1, mineral: 1, "no-eggs": 1, grass: -1, water2: -1, water3: -1, bug: -1, monster: -1 });
+  if (meta.stats.spatk <= 2) value -= 1; else if (meta.stats.spatk >= 10) value += 1;
+  if (meta.isLegendary) value += 1;
+  if (meta.isFinalStage || meta.isSingleStage) value += 1;
+  return clampCapacity(value);
+}
+export function calcStrength(meta) {
+  let value = 0;
+  value += sumFromList(meta.types, { fighting: 1, ice: 1, rock: 1, steel: 1, dragon: 1, fairy: -1, bug: -1, ghost: -1 });
+  value += sumFromList(meta.eggGroups, { monster: 1, dragon: 1, mineral: 1, "no-eggs": 1, humanshape: 1, amorphous: -1, bug: -1, grass: -1 });
+  if (meta.stats.atk <= 2) value -= 1; else if (meta.stats.atk >= 10) value += 1;
+  if (meta.weight >= 80) value += 1;
+  if (meta.weight <= 20) value -= 1;
+  if (meta.isLegendary) value += 1;
+  if (meta.isFinalStage || meta.isSingleStage) value += 1;
+  return clampCapacity(value);
+}
+export function calcMovement(meta) {
+  let value = 1;
+  value += sumFromList(meta.types, { electric: 2, fire: 1, dragon: 1, flying: 1, bug: 1, fighting: 1, rock: -1, ice: -1, steel: -1 });
+  value += sumFromList(meta.eggGroups, { field: 1, dragon: 1, flying: 1, humanshape: 1, "no-eggs": 1, monster: -1, ditto: -1, mineral: -1 });
+  if (meta.stats.spd <= 5) value -= 1; else if (meta.stats.spd >= 10) value += 1;
+  if (meta.isLegendary) value += 1;
+  if (meta.isFinalStage || meta.isSingleStage) value += 1;
+  return clampCapacity(value);
+}
